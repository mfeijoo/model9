<!DOCTYPE html>
<html lang="en-US">
<head>
<base href="../../../../">
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>AVERAGEIF function</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<script type="text/javascript" src="help2.js"></script><script type="text/javascript" src="fuse.js"></script><script type="text/javascript" src="paginathing.js"></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body itemscope="true" itemtype="http://schema.org/TechArticle">
<div class="header-extrawurst">
<header><div class="logo-container"><a class="logo" href="en-US/text/shared/main0108.html"><div class="symbol"></div>
<p>LibreOffice 6.1 Help</p></a></div></header><div class="modules">
<input id="modules" name="modules" type="checkbox"><label for="modules">Module</label><nav><a href="en-US/text/swriter/main0000.html?DbPAR=WRITER"><div class="writer-icon"></div>Writer</a><a href="en-US/text/scalc/main0000.html?DbPAR=CALC"><div class="calc-icon"></div>Calc</a><a href="en-US/text/simpress/main0000.html?DbPAR=IMPRESS"><div class="impress-icon"></div>Impress</a><a href="en-US/text/sdraw/main0000.html?DbPAR=DRAW"><div class="draw-icon"></div>Draw</a><a href="en-US/text/shared/explorer/database/main.html?DbPAR=BASE"><div class="base-icon"></div>Base</a><a href="en-US/text/smath/main0000.html?DbPAR=MATH"><div class="math-icon"></div>Math</a><a href="en-US/text/schart/main0000.html?DbPAR=CHART"><div class="chart-icon"></div>Chart</a><a href="en-US/text/sbasic/shared/main0601.html?DbPAR=BASIC"><div class="basic-icon"></div>Basic</a></nav>
</div>
</div>
<aside class="rightside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1">Contents</label><div id="Contents" class="contents-treeview"></div></aside><aside class="leftside"><div id="Index">
<div class="index-label">Index  🔎︎ </div>
<div id="Bookmarks">
<input id="search-bar" type="text" class="search"><nav class="index"></nav>
</div>
</div></aside><div id="DisplayArea" itemprop="articleBody">
<a name="averageif_function"></a>
<a name="bm_id19444137534261"></a>
<a name="bm_id237812197829662"></a>
  <meta itemprop="keywords" content="AVERAGEIF function">
  <meta itemprop="keywords" content="arithmetic mean,satisfying condition">

<h2 itemprop="articleSection" id="hd_id16852304621982">
<a name="averageif_head"></a>AVERAGEIF function</h2>
<p id="par_id7281266615152" class="paragraph"><span class="avis"><a name="averageif_des"></a>Returns the arithmetic mean of all cells in a range that satisfy a given condition. The AVERAGEIF function sums up all the results that match the logical test and divides this sum by the quantity of selected values.</span></p>

<h3 id="hd_id210572014129502">Syntax</h3>
<p id="par_id200801176228491" class="code">AVERAGEIF(Range; Criterion [; Average_Range ])</p>
<p id="par_id15226321619829" class="paragraph"><span class="emph">Range</span> – required argument. An array, a name of named range or a label of a column or a row containing numbers for averaging or numbers or text for the condition.</p>
<p id="par_id24499731228013" class="paragraph"><span class="emph">Criterion</span> – required argument. A condition in the form of expression or a cell reference with expression that defines what cells should be used to calculate the mean. The expression can contain text, numbers, regular expressions (if enabled in calculation options) or wildcards (if enabled in calculation options).</p>
<p id="par_id174711913219765" class="paragraph"><span class="emph">Average_Range</span> – optional. It is a range of values for calculating the mean.</p>
<div class="note">
<div class="noteicon"><img src="media/icon-themes/help/note.png" alt="Note Icon 
" title="Note Icon 
"></div>
<div class="notetext"><p>Note that if the <span class="emph">Average_Range</span> is not specified, <span class="emph">Range</span> is used for both, the calculation of the mean and the search according to the condition. If the <span class="emph">Average_Range</span> is specified, the <span class="emph">Range</span> is used only for the condition test, while <span class="emph">Average_Range</span> is used for the mean calculation.<br>
The <span class="emph">Criterion</span> needs to be a string expression, in particular, the <span class="emph">Criterion</span> needs to be enclosed in quotation marks ("Criterion") with the exception of the names of functions, cell references and an operation of a string concatenation (&amp;).</p></div>
</div>
<br><div class="embedded">
<a name="odff"></a>
<div class="note">
<div class="noteicon"><img src="media/icon-themes/help/note.png" alt="Note Icon 
" title="Note Icon 
"></div>
<div class="notetext"><p>This function is part of the Open Document Format for Office Applications (OpenDocument) standard Version 1.2. (ISO/IEC 26300:2-2015)</p></div>
</div>
<br>
</div>
<div class="warning">
<div class="noteicon"><img src="media/icon-themes/help/warning.png" alt="Warning Icon 
" title="Warning Icon 
"></div>
<div class="notetext"><p>If a cell in a range of values for calculating the mean is empty or contains text, function AVERAGEIF ignores this cell.<br>
If the whole range is empty, contains only text or all values of the range do not satisfy the condition (or any combination of those), the function returns the #DIV/0! error. </p></div>
</div>
<br>
<div class="embedded">
<a name="ex_func_average"></a>
<h3 id="hd_id2657394931588">Examples</h3>
<h4 id="hd_id2609201512474295">Consider the following table</h4>
<table border="1" class="" cellpadding="0" cellspacing="0">
  <tr>
    <td>
    </td>
    <td class="tableheadcell">
      <p id="par_id2509201517430799" class="tableheadintable">A</p>
    </td>
    <td class="tableheadcell">
      <p id="par_id250920151743116" class="tableheadintable">B</p>
    </td>
    <td class="tableheadcell">
      <p id="par_id2509201517431582" class="tableheadintable">C</p>
    </td>
  </tr>
  <tr>
    <td class="tableheadcell">
      <p id="par_id2509201517431967" class="tableheadintable">1</p>
    </td>
    <td>
      <p id="par_id18260631312423" class="tablecontentintable">Product Name</p>
    </td>
    <td>
      <p id="par_id2509201517433075" class="tablecontentintable">Sales</p>
    </td>
    <td>
      <p id="par_id2509201519383294" class="tablecontentintable">Revenue</p>
    </td>
  </tr>
  <tr>
    <td class="tableheadcell">
      <p id="par_id959660094035" class="tableheadintable">2</p>
    </td>
    <td>
      <p id="par_id2855779586764" class="tablecontentintable">pencil</p>
    </td>
    <td>
      <p id="par_id110202156219769" class="tablecontentintable">20</p>
    </td>
    <td>
      <p id="par_id23281929326512" class="tablecontentintable">65</p>
    </td>
  </tr>
  <tr>
    <td class="tableheadcell">
      <p id="par_id2509201517432278" class="tableheadintable">3</p>
    </td>
    <td>
      <p id="par_id24967262611733" class="tablecontentintable">pen</p>
    </td>
    <td>
      <p id="par_id2509201517433391" class="tablecontentintable">35</p>
    </td>
    <td>
      <p id="par_id250920151938352" class="tablecontentintable">85</p>
    </td>
  </tr>
  <tr>
    <td class="tableheadcell">
      <p id="par_id250920151743267" class="tableheadintable">4</p>
    </td>
    <td>
      <p id="par_id252542413030532" class="tablecontentintable">notebook</p>
    </td>
    <td>
      <p id="par_id2509201517433781" class="tablecontentintable">20</p>
    </td>
    <td>
      <p id="par_id2509201519383822" class="tablecontentintable">190</p>
    </td>
  </tr>
  <tr>
    <td class="tableheadcell">
      <p id="par_id2509201519371339" class="tableheadintable">5</p>
    </td>
    <td>
      <p id="par_id2509201519374677" class="tablecontentintable">book</p>
    </td>
    <td>
      <p id="par_id2509201519373350" class="tablecontentintable">17</p>
    </td>
    <td>
      <p id="par_id2509201519384171" class="tablecontentintable">180</p>
    </td>
  </tr>
    <tr>
    <td class="tableheadcell">
      <p id="par_id6009596127912" class="tableheadintable">6</p>
    </td>
    <td>
      <p id="par_id19479417931163" class="tablecontentintable">pencil-case</p>
    </td>
    <td>
      <p id="par_id85353130721737" class="tablecontentintable">not</p>
    </td>
    <td>
      <p id="par_id15693941827291" class="tablecontentintable">not</p>
    </td>
  </tr>
</table>
<br>
<div class="warning">
<div class="noteicon"><img src="media/icon-themes/help/warning.png" alt="Warning Icon 
" title="Warning Icon 
"></div>
<div class="notetext"><p>In all examples below, ranges for calculation contain the row #6, which is ignored because it contains text.</p></div>
</div>
<br>
</div>
<div class="warning">
<div class="noteicon"><img src="media/icon-themes/help/warning.png" alt="Warning Icon 
" title="Warning Icon 
"></div>
<div class="notetext"><p>In all calculations below, range for average calculation contains the row #6, but it is ignored, because it contains text.</p></div>
</div>
<br>
<h4 id="hd_id229513120314273">Simple usage</h4>
<p id="par_id2509201519225446" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&lt;35")</span></p>
<p id="par_id11322891219251" class="paragraph">Calculates the average for values of the range B2:B6 that are less than 35. Returns 19, because the second row does not participate in the calculation.</p>
<p id="par_id250920151922590" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&lt;"&amp;MAX(B2:B6))</span></p>
<p id="par_id3813266131474" class="paragraph">Calculates the average for values of the same range that are less than the maximum value of this range. Returns 19, because the largest value (the second row) does not participate in the calculation.</p>
<p id="par_id2509201519230832" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&gt;"&amp;SMALL(B2:B6;1))</span></p>
<p id="par_id243522732832394" class="paragraph">Calculates the average for values of the same range that are greater than the first smallest value of this range. Returns 25, because the first smallest value (the fourth row) does not participate in the calculation.</p>
<h4 id="hd_id2101254257133">Using the Average_Range</h4>
<p id="par_id2509201519315584" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&lt;35";C2:C6)</span></p>
<p id="par_id148222637631350" class="paragraph">The function searches what values are less than 35 in the B2:B6 range, and calculates the average of corresponding values from the C2:C6 range. Returns 145, because the second row does not participate in the calculation. </p>
<p id="par_id2509201519315535" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&gt;"&amp;MIN(B2:B6);C2:C6)</span></p>
<p id="par_id2412836525208" class="paragraph">The function searches what values from the range B2:B6 are greater than the least value in the B2:B6 range, and calculates the average of corresponding values from the C2:C6 range. Returns 113.3, because the fourth row (where there is the least value in the range B2:B6) does not participate in the calculation.</p>
<p id="par_id2509201519315547" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&lt;"&amp;LARGE(B2:B6;2);C2:C6)</span></p>
<p id="par_id173931101529497" class="paragraph">The function searches what values from the range B2:B6 are less than the second large value in the B2:B6 range, and calculates the average of corresponding values from the C2:C6 range. Returns 180, because only the fourth row participates in the calculation. </p>
<h4 id="hd_id30054471316969">Using regular expressions</h4>
<p id="par_id2509201519360514" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(A2:A6;"pen";B2:B6)</span></p>
<p id="par_id14714860719948" class="paragraph">The function searches what cells from the range A2:A6 contain only the word “pen”, and calculates the average of corresponding values from the B2:B6 range. Returns 35, because only the second row participates in the calculation. The search is performed in the A2:A6 range, but the values are returned from the B2:B6 range.</p>
<p id="par_id250920151936096" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(A2:A6;"pen.*";B2:B6)</span></p>
<p id="par_id26959239098104" class="paragraph">The function searches what cells from the range A2:A6 begin with “pen” ending with any quantity of other characters, and calculates the average of corresponding values from the B2:B6 range. Returns 27.5, because now also “pencil” satisfies the condition, and both, first and second rows participate in the calculation. </p>
<p id="par_id2509201519361352" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(A2:A6;".*book.*";B2:B6)</span></p>
<p id="par_id227041304619482" class="paragraph">The function searches what cells from the range A2:A6 contain “book” starting and ending with any quantity of other characters, and calculates the average of corresponding values from the B2:B6 range. Returns 18.5, because only third and fourth rows participate in the calculation.</p>
<h4 id="hd_id251309885188">Reference to a cell as a criterion</h4>
<p id="par_id177972099720424" class="paragraph">If you need to change a criterion easily, you may want to specify it in a separate cell and use a reference to this cell in the condition of AVERAGEIF function. </p>
<p id="par_id134941261230060" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(A2:A6;".*"&amp;E2&amp;".*";B2:B6)</span></p>
<p id="par_id172572288310247" class="paragraph">The function searches what cells from the range A2:A6 contain a combination of characters specified in E2 starting and ending with any quantity of other characters, and calculates the average of corresponding values from the B2:B6 range. If E2 = book, the function returns 18.5.</p>
<p id="par_id316901523627285" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&lt;"&amp;E2;C2:C6)</span></p>
<p id="par_id302181300528607" class="paragraph">The function searches what cells from the range B2:B6 are less than the value specified in E2, and calculates the average of corresponding values from the C2:C6 range. If E2 = 35, the function returns 145.</p>
<a name="relatedtopics"></a><div class="relatedtopics">
<p class="related" itemprop="mentions"><a name="related"></a><span class="emph">Related Topics</span>
</p>
<div class="relatedbody" itemprop="mentions">
    <p id="par_id11921178730928" class="paragraph">
        <a name="average_head"></a><a target="_top" href="en-US/text/scalc/01/04060184.html#average">AVERAGE</a>,
        <a name="averagea_head"></a><a target="_top" href="en-US/text/scalc/01/04060184.html#averagea">AVERAGEA</a>,
        <a name="avedev_head"></a><a target="_top" href="en-US/text/scalc/01/04060184.html#avedev">AVEDEV</a>
    </p>
    <p id="par_id11931178730928" class="paragraph">
        <a name="countifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_countifs.html">COUNTIFS</a>,
        <a name="minifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_minifs.html">MINIFS</a>,
        <a name="maxifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_maxifs.html">MAXIFS</a>,
        <a name="averageifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_averageifs.html">AVERAGEIFS</a>,
        <a name="sumifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_sumifs.html">SUMIFS</a>
    </p>
<p id="par_id251321802714497" class="paragraph"><a name="02100001"></a><a target="_top" href="en-US/text/shared/01/02100001.html">List of Regular Expressions</a>
</p>
</div>
</div>
<footer><div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p>This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/scalc/01/func_averageif.xhp" target="_blank">/text/scalc/01/func_averageif.xhp</a></p>
<p>Title is: AVERAGEIF function</p>
<p id="bm_module"></p>
<p id="bm_system"></p>
</div></footer>
</div>
<script type="text/javascript" src="en-US/bookmarks.js"></script><script type="text/javascript" src="en-US/contents.js"></script><script type="text/javascript" src="help.js"></script><script type="text/javascript">
                
                var module = getParameterByName("DbPAR");
                var system = getSystem();
                fixURL(module,system);
                var dbg = getParameterByName("Debug");
                if (dbg == null){dbg=0}
                document.getElementById("DEBUG").style.display = (dbg == 0) ? "none":"block";
                document.getElementById("bm_module").innerHTML ="Module is: "+module;
                document.getElementById("bm_system").innerHTML ="System is: "+system;
                
            </script>
</body>
</html>
