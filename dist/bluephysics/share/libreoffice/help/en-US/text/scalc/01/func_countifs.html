<!DOCTYPE html>
<html lang="en-US">
<head>
<base href="../../../../">
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>COUNTIFS function</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<script type="text/javascript" src="help2.js"></script><script type="text/javascript" src="fuse.js"></script><script type="text/javascript" src="paginathing.js"></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body itemscope="true" itemtype="http://schema.org/TechArticle">
<div class="header-extrawurst">
<header><div class="logo-container"><a class="logo" href="en-US/text/shared/main0108.html"><div class="symbol"></div>
<p>LibreOffice 6.1 Help</p></a></div></header><div class="modules">
<input id="modules" name="modules" type="checkbox"><label for="modules">Module</label><nav><a href="en-US/text/swriter/main0000.html?DbPAR=WRITER"><div class="writer-icon"></div>Writer</a><a href="en-US/text/scalc/main0000.html?DbPAR=CALC"><div class="calc-icon"></div>Calc</a><a href="en-US/text/simpress/main0000.html?DbPAR=IMPRESS"><div class="impress-icon"></div>Impress</a><a href="en-US/text/sdraw/main0000.html?DbPAR=DRAW"><div class="draw-icon"></div>Draw</a><a href="en-US/text/shared/explorer/database/main.html?DbPAR=BASE"><div class="base-icon"></div>Base</a><a href="en-US/text/smath/main0000.html?DbPAR=MATH"><div class="math-icon"></div>Math</a><a href="en-US/text/schart/main0000.html?DbPAR=CHART"><div class="chart-icon"></div>Chart</a><a href="en-US/text/sbasic/shared/main0601.html?DbPAR=BASIC"><div class="basic-icon"></div>Basic</a></nav>
</div>
</div>
<aside class="rightside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1">Contents</label><div id="Contents" class="contents-treeview"></div></aside><aside class="leftside"><div id="Index">
<div class="index-label">Index  ðŸ”Žï¸Ž </div>
<div id="Bookmarks">
<input id="search-bar" type="text" class="search"><nav class="index"></nav>
</div>
</div></aside><div id="DisplayArea" itemprop="articleBody">
<a name="countifs_function"></a>
<a name="bm_id449544954495"></a>
<a name="bm_id452245224522"></a>
  <meta itemprop="keywords" content="COUNTIFS function">
  <meta itemprop="keywords" content="counting row,satisfying criteria">
  <meta itemprop="keywords" content="counting column,satisfying criteria">

<h2 itemprop="articleSection" id="hd_id456845684568">
<a name="countifs_head"></a>COUNTIFS function</h2>
<p id="par_id462646264626" class="paragraph"><span class="avis"><a name="countifs_des"></a>Returns the count of cells that meet criteria in multiple ranges.</span></p>

<h3 id="hd_id465746574657">Syntax</h3>
<p id="par_id27421466710275" class="code">COUNTIFS(Range1; Criterion1 [; Range2; Criterion2 [; ...]])</p>
<p id="par_id242131304318587" class="paragraph"><span class="emph">Range1</span> â€“ required argument. It is a range of cells, a name of a named range or a label of a column or a row containing values for counting and finding the corresponding criterion.</p>
<div class="embedded">
<a name="par00"></a>
    <p id="par_id23526994221948" class="paragraph"><span class="emph">Criterion1</span> â€“ required argument. A string expression representing a logical condition or a cell reference to such string expression. The expression can contain text, numbers, regular expressions or wildcards (<a target="_top" href="en-US/text/shared/optionen/01060500.html#wildcards">if enabled in calculation options</a>).</p>
    <p id="par_id190621657742" class="paragraph"><span class="emph">Range2</span> â€“ Optional. Range2 and all the following mean the same as Range1.</p>
    <p id="par_id317001803813193" class="paragraph"><span class="emph">Criterion2</span> â€“ Optional. Criterion2 and all the following mean the same as Criterion1.</p>
</div>
<div class="warning">
<div class="noteicon"><img src="media/icon-themes/help/warning.png" alt="Warning Icon 
" title="Warning Icon 
"></div>
<div class="notetext"><p><span class="emph">Range1, Range2, ...</span> and <span class="emph">Criterion1, Criterion2, ...</span> must have the same size, otherwise the function returns err:502 - Invalid argument.</p></div>
</div>
<br>
<div class="embedded">
<a name="note01"></a>
    <div class="note">
<div class="noteicon"><img src="media/icon-themes/help/note.png" alt="Note Icon 
" title="Note Icon 
"></div>
<div class="notetext"><p>The logical relation between criteria can be defined as logical AND (conjunction). In other words, if and only if all given criteria are met, a value from the corresponding cell of the given <span class="emph">Func_Range</span> is taken into calculation.</p></div>
</div>
<br>
</div>
<div class="embedded">
<a name="par01"></a>
    <p id="par_id191527781733238" class="paragraph">The function can have up to 255 arguments, meaning that you can specify 127 criteria ranges and criteria for them.</p>
    <div class="warning">
<div class="noteicon"><img src="media/icon-themes/help/warning.png" alt="Warning Icon 
" title="Warning Icon 
"></div>
<div class="notetext"><p>If a cell contains TRUE, it is treated as 1, if a cell contains FALSE â€“ as 0 (zero).</p></div>
</div>
<br>
</div>
<div class="embedded">
<a name="odff"></a>
<div class="note">
<div class="noteicon"><img src="media/icon-themes/help/note.png" alt="Note Icon 
" title="Note Icon 
"></div>
<div class="notetext"><p>This function is part of the Open Document Format for Office Applications (OpenDocument) standard Version 1.2. (ISO/IEC 26300:2-2015)</p></div>
</div>
<br>
</div>
<div class="embedded">
<a name="ex_func_average"></a>
<h3 id="hd_id2657394931588">Examples</h3>
<h4 id="hd_id2609201512474295">Consider the following table</h4>
<table border="1" class="" cellpadding="0" cellspacing="0">
  <tr>
    <td>
    </td>
    <td class="tableheadcell">
      <p id="par_id2509201517430799" class="tableheadintable">A</p>
    </td>
    <td class="tableheadcell">
      <p id="par_id250920151743116" class="tableheadintable">B</p>
    </td>
    <td class="tableheadcell">
      <p id="par_id2509201517431582" class="tableheadintable">C</p>
    </td>
  </tr>
  <tr>
    <td class="tableheadcell">
      <p id="par_id2509201517431967" class="tableheadintable">1</p>
    </td>
    <td>
      <p id="par_id18260631312423" class="tablecontentintable">Product Name</p>
    </td>
    <td>
      <p id="par_id2509201517433075" class="tablecontentintable">Sales</p>
    </td>
    <td>
      <p id="par_id2509201519383294" class="tablecontentintable">Revenue</p>
    </td>
  </tr>
  <tr>
    <td class="tableheadcell">
      <p id="par_id959660094035" class="tableheadintable">2</p>
    </td>
    <td>
      <p id="par_id2855779586764" class="tablecontentintable">pencil</p>
    </td>
    <td>
      <p id="par_id110202156219769" class="tablecontentintable">20</p>
    </td>
    <td>
      <p id="par_id23281929326512" class="tablecontentintable">65</p>
    </td>
  </tr>
  <tr>
    <td class="tableheadcell">
      <p id="par_id2509201517432278" class="tableheadintable">3</p>
    </td>
    <td>
      <p id="par_id24967262611733" class="tablecontentintable">pen</p>
    </td>
    <td>
      <p id="par_id2509201517433391" class="tablecontentintable">35</p>
    </td>
    <td>
      <p id="par_id250920151938352" class="tablecontentintable">85</p>
    </td>
  </tr>
  <tr>
    <td class="tableheadcell">
      <p id="par_id250920151743267" class="tableheadintable">4</p>
    </td>
    <td>
      <p id="par_id252542413030532" class="tablecontentintable">notebook</p>
    </td>
    <td>
      <p id="par_id2509201517433781" class="tablecontentintable">20</p>
    </td>
    <td>
      <p id="par_id2509201519383822" class="tablecontentintable">190</p>
    </td>
  </tr>
  <tr>
    <td class="tableheadcell">
      <p id="par_id2509201519371339" class="tableheadintable">5</p>
    </td>
    <td>
      <p id="par_id2509201519374677" class="tablecontentintable">book</p>
    </td>
    <td>
      <p id="par_id2509201519373350" class="tablecontentintable">17</p>
    </td>
    <td>
      <p id="par_id2509201519384171" class="tablecontentintable">180</p>
    </td>
  </tr>
    <tr>
    <td class="tableheadcell">
      <p id="par_id6009596127912" class="tableheadintable">6</p>
    </td>
    <td>
      <p id="par_id19479417931163" class="tablecontentintable">pencil-case</p>
    </td>
    <td>
      <p id="par_id85353130721737" class="tablecontentintable">not</p>
    </td>
    <td>
      <p id="par_id15693941827291" class="tablecontentintable">not</p>
    </td>
  </tr>
</table>
<br>
<div class="warning">
<div class="noteicon"><img src="media/icon-themes/help/warning.png" alt="Warning Icon 
" title="Warning Icon 
"></div>
<div class="notetext"><p>In all examples below, ranges for calculation contain the row #6, which is ignored because it contains text.</p></div>
</div>
<br>
</div>
<h4 id="hd_id3861259759512">Simple usage</h4>
<p id="par_id15856592423333" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=COUNTIFS(B2:B6;"&gt;=20")</span></p>
<p id="par_id323511393121175" class="paragraph">Counts the amount of rows of the range B2:B6 with values greater than or equal to 20. Returns 3, because the fifth and the sixth rows do not meet the criterion.</p>
<p id="par_id74301057922522" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=COUNTIFS(B2:B6;"&gt;=20";C2:C6;"&gt;70")</span></p>
<p id="par_id109622995127628" class="paragraph">Counts the amount of rows that contain simultaneously values greater than 70 in the C2:C6 range and values greater than or equal to 20 in the B2:B6 range. Returns 2, because the second, the fifth and the sixth rows do not meet at least one criterion.</p>
<h4 id="hd_id298462825526166">Using regular expressions and nested functions</h4>
<p id="par_id22736248573471" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=COUNTIFS(B2:B6;"[:alpha:]*")</span></p>
<p id="par_id22137303324873" class="paragraph">Counts the amount of rows of the B2:B6 range that contain only alphabet symbols. Returns 1, because only sixth row meets the criterion.</p>
<p id="par_id82271340221411" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=COUNTIFS(B2:B6;"&gt;"&amp;MIN(B2:B6);B2:B6;"&lt;"&amp;MAX(B2:B6))</span></p>
<p id="par_id1105320769334" class="paragraph">Counts the amount of rows of the B2:B6 range excluding rows with minimum and maximum values of this range. Returns 2, because the third, the fifth and the sixth rows do not meet at least one criterion.</p>
<p id="par_id267603146513224" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=COUNTIFS(A2:A6;"pen.*";B2:B6;"&lt;"&amp;MAX(B2:B6))</span></p>
<p id="par_id111252614832220" class="paragraph">Counts the amount of rows that correspond to all cells of the A2:A6 range starting with "pen" and to all cells of the B2:B6 range with exception of its maximum. Returns 1, because only second row meets all criteria.</p>
<h4 id="hd_id212582362610399">Reference to a cell as a criterion</h4>
<p id="par_id3245551524846" class="paragraph">If you need to change a criterion easily, you may want to specify it in a separate cell and use a reference to this cell in the condition of the COUNTIFS function. For example, the above function can be rewritten as follows:</p>
<p id="par_id109501907712434" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=COUNTIFS(A2:A6;E2&amp;".*";B2:B6;"&lt;"&amp;MAX(B2:B6))</span></p>
<p id="par_id738533068520" class="paragraph">If E2 = pen, the function returns 1, because the link to the cell is substituted with its content and it works as a function above.</p>
<div class="embedded">
<a name="func_ifs"></a>
        <p id="par_id721528312694192" class="paragraph"></p>
    </div>
<a name="relatedtopics"></a><div class="relatedtopics">
<p class="related" itemprop="mentions"><a name="related"></a><span class="emph">Related Topics</span>
</p>
<div class="relatedbody" itemprop="mentions">
    <p id="par_id11921178730928" class="paragraph">
        <a name="count_head"></a><a target="_top" href="en-US/text/scalc/01/04060181.html#count">COUNT</a>,
        <a name="countif_head"></a><a target="_top" href="en-US/text/scalc/01/04060181.html#countif">COUNTIF</a>,
        <a name="countblank_head"></a><a target="_top" href="en-US/text/scalc/01/04060181.html#countblank">COUNTBLANK</a>,
        <a name="counta_head"></a><a target="_top" href="en-US/text/scalc/01/04060181.html#counta">COUNTA</a>
    </p>
    <p id="par_id11931178730928" class="paragraph">
        <a name="countifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_countifs.html">COUNTIFS</a>,
        <a name="minifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_minifs.html">MINIFS</a>,
        <a name="maxifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_maxifs.html">MAXIFS</a>,
        <a name="averageifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_averageifs.html">AVERAGEIFS</a>,
        <a name="sumifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_sumifs.html">SUMIFS</a>
    </p>
<p id="par_id235992404316585" class="paragraph"><a name="02100001"></a><a target="_top" href="en-US/text/shared/01/02100001.html">List of Regular Expressions</a>
</p>
</div>
</div>
<footer><div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p>This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/scalc/01/func_countifs.xhp" target="_blank">/text/scalc/01/func_countifs.xhp</a></p>
<p>Title is: COUNTIFS function</p>
<p id="bm_module"></p>
<p id="bm_system"></p>
</div></footer>
</div>
<script type="text/javascript" src="en-US/bookmarks.js"></script><script type="text/javascript" src="en-US/contents.js"></script><script type="text/javascript" src="help.js"></script><script type="text/javascript">
                
                var module = getParameterByName("DbPAR");
                var system = getSystem();
                fixURL(module,system);
                var dbg = getParameterByName("Debug");
                if (dbg == null){dbg=0}
                document.getElementById("DEBUG").style.display = (dbg == 0) ? "none":"block";
                document.getElementById("bm_module").innerHTML ="Module is: "+module;
                document.getElementById("bm_system").innerHTML ="System is: "+system;
                
            </script>
</body>
</html>
