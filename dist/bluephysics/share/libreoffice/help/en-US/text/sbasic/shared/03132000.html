<!DOCTYPE html>
<html lang="en-US">
<head>
<base href="../../../../">
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>CreateUnoListener Function</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<script type="text/javascript" src="help2.js"></script><script type="text/javascript" src="fuse.js"></script><script type="text/javascript" src="paginathing.js"></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body itemscope="true" itemtype="http://schema.org/TechArticle">
<div class="header-extrawurst">
<header><div class="logo-container"><a class="logo" href="en-US/text/shared/main0108.html"><div class="symbol"></div>
<p>LibreOffice 6.1 Help</p></a></div></header><div class="modules">
<input id="modules" name="modules" type="checkbox"><label for="modules">Module</label><nav><a href="en-US/text/swriter/main0000.html?DbPAR=WRITER"><div class="writer-icon"></div>Writer</a><a href="en-US/text/scalc/main0000.html?DbPAR=CALC"><div class="calc-icon"></div>Calc</a><a href="en-US/text/simpress/main0000.html?DbPAR=IMPRESS"><div class="impress-icon"></div>Impress</a><a href="en-US/text/sdraw/main0000.html?DbPAR=DRAW"><div class="draw-icon"></div>Draw</a><a href="en-US/text/shared/explorer/database/main.html?DbPAR=BASE"><div class="base-icon"></div>Base</a><a href="en-US/text/smath/main0000.html?DbPAR=MATH"><div class="math-icon"></div>Math</a><a href="en-US/text/schart/main0000.html?DbPAR=CHART"><div class="chart-icon"></div>Chart</a><a href="en-US/text/sbasic/shared/main0601.html?DbPAR=BASIC"><div class="basic-icon"></div>Basic</a></nav>
</div>
</div>
<aside class="rightside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1">Contents</label><div id="Contents" class="contents-treeview"></div></aside><aside class="leftside"><div id="Index">
<div class="index-label">Index  ðŸ”Žï¸Ž </div>
<div id="Bookmarks">
<input id="search-bar" type="text" class="search"><nav class="index"></nav>
</div>
</div></aside><div id="DisplayArea" itemprop="articleBody">


<a name="createunolistener"></a>
<a name="bm_id3155150"></a>
  <meta itemprop="keywords" content="CreateUnoListener function">



<h1 itemprop="articleSection" id="hd_id3155150">CreateUnoListener Function</h1>
<p id="par_id3149346" class="paragraph">Creates a Listener instance.</p>

<p id="par_id3153681" class="paragraph">Many Uno interfaces let you register listeners on a special listener interface. This allows you to listen for specific events and call up the appropriate listener method. The CreateUnoListener function waits for the called listener interface and then passes the interface an object that the interface supports. This object is then passed to the method to register the listener.</p>

<h2 itemprop="articleSection" id="hd_id3148685">Syntax:</h2>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">oListener = CreateUnoListener( Prefixname, ListenerInterfaceName )</pre>
<br>
</div>

<h2 itemprop="articleSection" id="hd_id3147574">Example:</h2>
<p id="par_id3154046" class="paragraph">The following example is based on a Basic library object.</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">Dim oListener</pre>
<br>
<pre class="bascodepar">oListener = CreateUnoListener( "ContListener_","com.sun.star.container.XContainerListener" )</pre>
<br>
</div>
<p id="par_id3149294" class="paragraph">The CreateUnoListener method requires two parameters. The first is a prefix and is explained in detail below. The second parameter is the fully qualified name of the Listener interface that you want to use.</p>
<p id="par_id3149670" class="paragraph">The Listener must then be added to the Broadcaster Object. This is done by calling the appropriate method for adding a Listener. These methods always follow the pattern "addFooListener", where "Foo" is the Listener Interface Type, without the 'X'. In this example, the addContainerListener method is called to register the XContainerListener:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">Dim oLib</pre>
<br>
<pre class="bascodepar">oLib = BasicLibraries.Library1 ' Library1 must exist!</pre>
<br>
<pre class="bascodepar">oLib.addContainerListener( oListener ) ' Register the listener</pre>
<br>
</div>
<p id="par_id3154138" class="paragraph">The Listener is now registered. When an event occurs, the corresponding Listener calls the appropriate method from the com.sun.star.container.XContainerListener Interface.</p>
<p id="par_id3148922" class="paragraph">The prefix calls registered Listeners from Basic-subroutines. The Basic run-time system searches for Basic-subroutines or functions that have the name "PrefixListenerMethode" and calls them when found. Otherwise, a run-time error occurs.</p>
<p id="par_id3150768" class="paragraph">In this example, the Listener-Interface uses the following methods:</p>

<ul>
  <li>
    <p id="par_id3151176" class="listitem">disposing:</p>
  </li>
  <li>
    <p id="par_id3145173" class="listitem">Listener base interface (com.sun.star.lang.XEventListener): base interface for all Listener Interfaces</p>
  </li>
  <li>
    <p id="par_id3156212" class="listitem">elementInserted:</p>
  </li>
  <li>
    <p id="par_id3159254" class="listitem">Method of the com.sun.star.container.XContainerListener interface</p>
  </li>
  <li>
    <p id="par_id3147287" class="listitem">elementRemoved:</p>
  </li>
  <li>
    <p id="par_id3146119" class="listitem">Method of the com.sun.star.container.XContainerListener interface</p>
  </li>
  <li>
    <p id="par_id3153951" class="listitem">elementReplaced:</p>
  </li>
  <li>
    <p id="par_id3154013" class="listitem">Method of the com.sun.star.container.XContainerListener interface</p>
  </li>
</ul>
<p id="par_id3147435" class="paragraph">In this example, the prefix is ContListener_. The following subroutines must therefore be implemented in Basic:</p>

<ul>
  <li>
    <p id="par_id3155411" class="listitem">ContListener_disposing</p>
  </li>
  <li>
    <p id="par_id3146923" class="listitem">ContListener_elementInserted</p>
  </li>
  <li>
    <p id="par_id3147318" class="listitem">ContListener_elementRemoved</p>
  </li>
  <li>
    <p id="par_id3152578" class="listitem">ContListener_elementReplaced</p>
  </li>
</ul>
<p id="par_id3150592" class="paragraph">An event structure type that contains information about an event exists for every Listener type. When a Listener method is called, an instance of this event is passed to the method as a parameter. Basic Listener methods can also call these event objects, so long as the appropriate parameter is passed in the Sub declaration. For example:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">Sub ContListener_disposing( oEvent )</pre>
<br>
<pre class="bascodepar">    MsgBox "disposing"</pre>
<br>
<pre class="bascodepar">    MsgBox oEvent.Dbg_Properties</pre>
<br>
<pre class="bascodepar">End Sub</pre>
<br>
<pre class="bascodepar"> </pre>
<br>
<pre class="bascodepar">Sub ContListener_elementInserted( oEvent )</pre>
<br>
<pre class="bascodepar">    MsgBox "elementInserted"</pre>
<br>
<pre class="bascodepar">    MsgBox oEvent.Dbg_Properties</pre>
<br>
<pre class="bascodepar">End Sub</pre>
<br>
<pre class="bascodepar"> </pre>
<br>
<pre class="bascodepar">Sub ContListener_elementRemoved( oEvent )</pre>
<br>
<pre class="bascodepar">    MsgBox "elementRemoved"</pre>
<br>
<pre class="bascodepar">    MsgBox oEvent.Dbg_Properties</pre>
<br>
<pre class="bascodepar">End Sub</pre>
<br>
<pre class="bascodepar"> </pre>
<br>
<pre class="bascodepar">Sub ContListener_elementReplaced( oEvent )</pre>
<br>
<pre class="bascodepar">    MsgBox "elementReplaced"</pre>
<br>
<pre class="bascodepar">    MsgBox oEvent.Dbg_Properties</pre>
<br>
<pre class="bascodepar">End Sub</pre>
<br>
</div>
<p id="par_id3156056" class="paragraph">You do not need to include the parameter of an event object if the object is not used:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">' Minimal implementation of Sub disposing</pre>
<br>
<pre class="bascodepar">Sub ContListener_disposing</pre>
<br>
<pre class="bascodepar">End Sub</pre>
<br>
</div>
<div class="warning">
<div class="noteicon"><img src="media/icon-themes/help/warning.png" alt="Warning Icon 
" title="Warning Icon 
"></div>
<div class="notetext"><p>Listener methods must <span class="emph">always</span> be implemented to avoid Basic run-time errors.</p></div>
</div>
<br>
<footer><div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p>This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/sbasic/shared/03132000.xhp" target="_blank">/text/sbasic/shared/03132000.xhp</a></p>
<p>Title is: CreateUnoListener Function</p>
<p id="bm_module"></p>
<p id="bm_system"></p>
</div></footer>
</div>
<script type="text/javascript" src="en-US/bookmarks.js"></script><script type="text/javascript" src="en-US/contents.js"></script><script type="text/javascript" src="help.js"></script><script type="text/javascript">
                
                var module = getParameterByName("DbPAR");
                var system = getSystem();
                fixURL(module,system);
                var dbg = getParameterByName("Debug");
                if (dbg == null){dbg=0}
                document.getElementById("DEBUG").style.display = (dbg == 0) ? "none":"block";
                document.getElementById("bm_module").innerHTML ="Module is: "+module;
                document.getElementById("bm_system").innerHTML ="System is: "+system;
                
            </script>
</body>
</html>
