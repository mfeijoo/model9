<!DOCTYPE html>
<html lang="en-US">
<head>
<base href="../../../../">
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>Using Procedures and Functions</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<script type="text/javascript" src="help2.js"></script><script type="text/javascript" src="fuse.js"></script><script type="text/javascript" src="paginathing.js"></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body itemscope="true" itemtype="http://schema.org/TechArticle">
<div class="header-extrawurst">
<header><div class="logo-container"><a class="logo" href="en-US/text/shared/main0108.html"><div class="symbol"></div>
<p>LibreOffice 6.1 Help</p></a></div></header><div class="modules">
<input id="modules" name="modules" type="checkbox"><label for="modules">Module</label><nav><a href="en-US/text/swriter/main0000.html?DbPAR=WRITER"><div class="writer-icon"></div>Writer</a><a href="en-US/text/scalc/main0000.html?DbPAR=CALC"><div class="calc-icon"></div>Calc</a><a href="en-US/text/simpress/main0000.html?DbPAR=IMPRESS"><div class="impress-icon"></div>Impress</a><a href="en-US/text/sdraw/main0000.html?DbPAR=DRAW"><div class="draw-icon"></div>Draw</a><a href="en-US/text/shared/explorer/database/main.html?DbPAR=BASE"><div class="base-icon"></div>Base</a><a href="en-US/text/smath/main0000.html?DbPAR=MATH"><div class="math-icon"></div>Math</a><a href="en-US/text/schart/main0000.html?DbPAR=CHART"><div class="chart-icon"></div>Chart</a><a href="en-US/text/sbasic/shared/main0601.html?DbPAR=BASIC"><div class="basic-icon"></div>Basic</a></nav>
</div>
</div>
<aside class="rightside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1">Contents</label><div id="Contents" class="contents-treeview"></div></aside><aside class="leftside"><div id="Index">
<div class="index-label">Index  ðŸ”Žï¸Ž </div>
<div id="Bookmarks">
<input id="search-bar" type="text" class="search"><nav class="index"></nav>
</div>
</div></aside><div id="DisplayArea" itemprop="articleBody">


<a name="prozedur"></a>
<a name="bm_id3149456"></a>
  <meta itemprop="keywords" content="procedures">
  <meta itemprop="keywords" content="functions,using">
  <meta itemprop="keywords" content="variables,passing to procedures and functions">
  <meta itemprop="keywords" content="parameters,for procedures and functions">
  <meta itemprop="keywords" content="parameters,passing by reference or value">
  <meta itemprop="keywords" content="variables,scope">
  <meta itemprop="keywords" content="scope of variables">
  <meta itemprop="keywords" content="GLOBAL variables">
  <meta itemprop="keywords" content="PUBLIC variables">
  <meta itemprop="keywords" content="PRIVATE variables">
  <meta itemprop="keywords" content="functions,return value type">
  <meta itemprop="keywords" content="return value type of functions">



<h1 itemprop="articleSection" id="hd_id3149456">Using Procedures and Functions</h1>
<p id="par_id3150767" class="paragraph">The following describes the basic use of procedures and functions in LibreOffice Basic.</p>

<div class="note">
<div class="noteicon"><img src="media/icon-themes/help/note.png" alt="Note Icon 
" title="Note Icon 
"></div>
<div class="notetext"><p>When you create a new module, LibreOffice Basic automatically inserts a SUB called "Main". This default name has nothing to do with the order or the starting point of a LibreOffice Basic project. You can also safely rename this SUB.</p></div>
</div>
<br>
<div class="note">
<div class="noteicon"><img src="media/icon-themes/help/note.png" alt="Note Icon 
" title="Note Icon 
"></div>
<div class="notetext"><p>Some restrictions apply for the names of your public variables, subs, and functions. You must not use the same name as one of the modules of the same library.</p></div>
</div>
<br>
<p id="par_id3154124" class="paragraph">Procedures (SUBS) and functions (FUNCTIONS) help you maintaining a structured overview by separating a program into logical pieces.</p>
<p id="par_id3153193" class="paragraph">One benefit of procedures and functions is that, once you have developed a program code containing task components, you can use this code in another project.</p>

<h2 itemprop="articleSection" id="hd_id3153770">Passing Variables to Procedures (SUB) and Functions (FUNCTION)</h2>
<p id="par_id3155414" class="paragraph">Variables can be passed to both procedures and functions. The SUB or FUNCTION must be declared to expect parameters:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">Sub SubName(Parameter1 As Type, Parameter2 As Type,...)</pre>
<br>
<pre class="bascodepar">Program code</pre>
<br>
<pre class="bascodepar">End Sub</pre>
<br>
</div>
<p id="par_id3152577" class="paragraph">The SUB is called using the following syntax:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">SubName(Value1, Value2,...)</pre>
<br>
</div>
<p id="par_id3147124" class="paragraph">The parameters passed to a SUB must fit to those specified in the SUB declaration.</p>
<p id="par_id3147397" class="paragraph">The same process applies to FUNCTIONS. In addition, functions always return a function result. The result of a function is defined by assigning the return value to the function name:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">Function FunctionName(Parameter1 As Type, Parameter2 As Type,...) As Type</pre>
<br>
<pre class="bascodepar">Program code</pre>
<br>
<pre class="bascodepar">FunctionName=Result</pre>
<br>
<pre class="bascodepar">End Function</pre>
<br>
</div>
<p id="par_id3153839" class="paragraph">The FUNCTION is called using the following syntax:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">Variable=FunctionName(Parameter1, Parameter2,...)</pre>
<br>
</div>
<div class="tip">
<div class="noteicon"><img src="media/icon-themes/help/tip.png" alt="Tip Icon 
" title="Tip Icon 
"></div>
<div class="notetext"><p>You can also use the fully qualified name to call a procedure or function:<br> <span class="literal">Library.Module.Macro()</span> <br> For example, to call the Autotext macro from the Gimmicks library, use the following command:<br> <span class="literal">Gimmicks.AutoText.Main()</span> </p></div>
</div>
<br>

<h2 itemprop="articleSection" id="hd_id3156276">Passing Variables by Value or Reference</h2>
<p id="par_id3155765" class="paragraph">Parameters can be passed to a SUB or a FUNCTION either by reference or by value. Unless otherwise specified, a parameter is always passed by reference. That means that a SUB or a FUNCTION gets the parameter and can read and modify its value.</p>
<p id="par_id3145640" class="paragraph">If you want to pass a parameter by value insert the key word "ByVal" in front of the parameter when you call a SUB or FUNCTION, for example:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">Result = Function(ByVal Parameter)</pre>
<br>
</div>
<p id="par_id3149258" class="paragraph">In this case, the original content of the parameter will not be modified by the FUNCTION since it only gets the value and not the parameter itself.</p>

<h2 itemprop="articleSection" id="hd_id3150982">Scope of Variables</h2>
<p id="par_id3149814" class="paragraph">A variable defined within a SUB or FUNCTION, only remains valid until the procedure is exited. This is known as a "local" variable. In many cases, you need a variable to be valid in all procedures, in every module of all libraries, or after a SUB or FUNCTION is exited.</p>

<h3 id="hd_id3154186">Declaring Variables Outside a SUB or FUNCTION</h3>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">Global VarName As TYPENAME</pre>
<br>
</div>
<p id="par_id3145258" class="paragraph">The variable is valid as long as the LibreOffice session lasts.</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">Public VarName As TYPENAME</pre>
<br>
</div>
<p id="par_id3150088" class="paragraph">The variable is valid in all modules.</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">Private VarName As TYPENAME</pre>
<br>
</div>
<p id="par_id3152994" class="paragraph">The variable is only valid in this module.</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">Dim VarName As TYPENAME</pre>
<br>
</div>
<p id="par_id3150368" class="paragraph">The variable is only valid in this module.</p>

<h3 id="hd_id5097506">Example for private variables</h3>
<p id="par_id8738975" class="paragraph">Enforce private variables to be private across modules by setting CompatibilityMode(true).</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">' ***** Module1 *****</pre>
<br>
<pre class="bascodepar">Private myText As String</pre>
<br>
<pre class="bascodepar">Sub initMyText</pre>
<br>
<pre class="bascodepar">    myText = "Hello"</pre>
<br>
<pre class="bascodepar">    Print "In module1 : ", myText</pre>
<br>
<pre class="bascodepar">End Sub</pre>
<br>
<pre class="bascodepar"> </pre>
<br>
<pre class="bascodepar">' ***** Module2 *****</pre>
<br>
<pre class="bascodepar">'Option Explicit</pre>
<br>
<pre class="bascodepar">Sub demoBug</pre>
<br>
<pre class="bascodepar">    CompatibilityMode( true )</pre>
<br>
<pre class="bascodepar">    initMyText</pre>
<br>
<pre class="bascodepar">    ' Now returns empty string</pre>
<br>
<pre class="bascodepar">    ' (or rises error for Option Explicit)</pre>
<br>
<pre class="bascodepar">    Print "Now in module2 : ", myText</pre>
<br>
<pre class="bascodepar">End Sub</pre>
<br>
</div>

<h3 id="hd_id3154368">Saving Variable Content after Exiting a SUB or FUNCTION</h3>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">Static VarName As TYPENAME</pre>
<br>
</div>
<p id="par_id3154486" class="paragraph">The variable retains its value until the next time the FUNCTION or SUB is entered. The declaration must exist inside a SUB or a FUNCTION.</p>

<h2 itemprop="articleSection" id="hd_id3155809">Specifying the Return Value Type of a FUNCTION</h2>
<p id="par_id3149404" class="paragraph">As with variables, include a type-declaration character after the function name, or the type indicated by "As" and the corresponding key word at the end of the parameter list to define the type of the function's return value, for example:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet">
<pre class="bascodepar">Function WordCount(WordText As String) As Integer</pre>
<br>
</div>
<footer><div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p>This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/sbasic/shared/01020300.xhp" target="_blank">/text/sbasic/shared/01020300.xhp</a></p>
<p>Title is: Using Procedures and Functions</p>
<p id="bm_module"></p>
<p id="bm_system"></p>
</div></footer>
</div>
<script type="text/javascript" src="en-US/bookmarks.js"></script><script type="text/javascript" src="en-US/contents.js"></script><script type="text/javascript" src="help.js"></script><script type="text/javascript">
                
                var module = getParameterByName("DbPAR");
                var system = getSystem();
                fixURL(module,system);
                var dbg = getParameterByName("Debug");
                if (dbg == null){dbg=0}
                document.getElementById("DEBUG").style.display = (dbg == 0) ? "none":"block";
                document.getElementById("bm_module").innerHTML ="Module is: "+module;
                document.getElementById("bm_system").innerHTML ="System is: "+system;
                
            </script>
</body>
</html>
